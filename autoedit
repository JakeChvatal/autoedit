autoedit.edit() {
    cmdstr=${BUFFER//[$'\t\r\n']}
    extension="${cmdstr##*.}" 
    edit_ext=(
        js 
        jsx 
        py 
        txt
        org 
        md 
        yml 
        yaml
        toml 
        json
    )

    edit_files=(
        Dockerfile 
        # .gitignore TODO allow for editing dotfiles
        # .zshrc
    )
     
    if [[ ! $cmdstr =~ ( |\') ]]; then
        if [ -z ${cmdstr##*.*} ]; then
            if [[ ! "$(($edit_ext[(Ie)$extension]))" == 0 ]];  then
                # if the file name has a text editing extension, 
                # use the default editor to edit the file
                cmd="$EDITOR $cmdstr"
            elif [[ -z $DISPLAY ]] && [[ $(tty) = /dev/tty1 ]]; then 
                # if the file type isn't supported and GUI is available,
                # touch it and open it with X
                cmd="touch $cmdstr && xdg-open $cmdstr"
            fi
        elif [[ ! "$(($edit_files[(Ie)$cmdstr]))" == 0 ]]; then
            # if the full name of the file matches, edit it
            # TODO match only the last . or / (support full paths)
            cmd="$EDITOR $cmdstr"
        fi
    fi
    
    return cmd
}

autoedit.hook() {
    autoedit.edit $BUFFER
    zle .accept-line
}

zle -N accept-line autoedit

[[ -o kshautoload ]] || autoedit "$@"
